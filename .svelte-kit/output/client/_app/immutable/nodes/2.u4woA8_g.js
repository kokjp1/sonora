import"../chunks/DsnmJJEf.js";import{i as se}from"../chunks/BaIsjuet.js";import{o as oe,a as le,s as W,e as G}from"../chunks/BAwLGipD.js";import{h as gt,p as ue,aY as lt,aZ as he,f as H,z as kt,D as it,i as $,j as ce,q as l,G as D,aM as x,aU as F,J as P,I as M,C as ge,m as E}from"../chunks/Bx2BwwXG.js";import{i as tt}from"../chunks/BDAM0HAq.js";import{s as ct}from"../chunks/Dfm8iPyl.js";import{a as fe,g as me,b as de,r as At,l as ve,c as rt}from"../chunks/Cg3hiqjO.js";const _e=!0,Nt=[...` 	
\r\fÂ \v\uFEFF`];function be(r,e,t){var i=r==null?"":""+r;if(e&&(i=i?i+" "+e:e),t){for(var n in t)if(t[n])i=i?i+" "+n:n;else if(i.length)for(var a=n.length,s=0;(s=i.indexOf(n,s))>=0;){var o=s+a;(s===0||Nt.includes(i[s-1]))&&(o===i.length||Nt.includes(i[o]))?i=(s===0?"":i.substring(0,s))+i.substring(o+1):s=o}}return i===""?null:i}function pe(r,e){return r==null?null:String(r)}function Ct(r,e,t,i,n,a){var s=r.__className;if(gt||s!==t||s===void 0){var o=be(t,i,a);(!gt||o!==r.getAttribute("class"))&&(o==null?r.removeAttribute("class"):r.className=o),r.__className=t}else if(a&&n!==a)for(var c in a){var u=!!a[c];(n==null||u!==!!n[c])&&r.classList.toggle(c,u)}return a}function Rt(r,e,t,i){var n=r.__style;if(gt||n!==e){var a=pe(e);(!gt||a!==r.getAttribute("style"))&&(a==null?r.removeAttribute("style"):r.style.cssText=a),r.__style=e}return i}const we=_e;class ye{constructor(e,t){this.pixels=e,this.opts=t;const{sigBits:i}=t,n=(S,R,y)=>(S<<2*i)+(R<<i)+y;this.getColorIndex=n;const a=8-i,s=1<<3*i,o=new Uint32Array(s);let c,u,h,_,p,m,f,d,b,O;c=h=p=0,u=_=m=Number.MAX_VALUE;const k=e.length/4;let q=0;for(;q<k;){const S=q*4;if(q++,f=e[S+0],d=e[S+1],b=e[S+2],O=e[S+3],O===0)continue;f=f>>a,d=d>>a,b=b>>a;const R=n(f,d,b);o[R]===void 0&&(o[R]=0),o[R]+=1,f>c&&(c=f),f<u&&(u=f),d>h&&(h=d),d<_&&(_=d),b>p&&(p=b),b<m&&(m=b)}this._colorCount=o.reduce((S,R)=>R>0?S+1:S,0),this.hist=o,this.rmax=c,this.rmin=u,this.gmax=h,this.gmin=_,this.bmax=p,this.bmin=m}get colorCount(){return this._colorCount}}class xe{scaleDown(e){const t=this.getWidth(),i=this.getHeight();let n=1;if(e.maxDimension>0){const a=Math.max(t,i);a>e.maxDimension&&(n=e.maxDimension/a)}else n=1/e.quality;n<1&&this.resize(t*n,i*n,n)}}function ke(r,e){var t;if(e.length>0){const i=r.data,n=i.length/4;let a,s,o,c,u;for(let h=0;h<n;h++){a=h*4,s=i[a+0],o=i[a+1],c=i[a+2],u=i[a+3];for(let _=0;_<e.length;_++)if(!((t=e[_])!=null&&t.call(e,s,o,c,u))){i[a+3]=0;break}}}return r}function Ce(r){const e=new URL(r,location.href);return e.protocol===location.protocol&&e.host===location.host&&e.port===location.port}function De(r,e){const t=new URL(r),i=new URL(e);return t.protocol===i.protocol&&t.hostname===i.hostname&&t.port===i.port}class Me extends xe{_getCanvas(){if(!this._canvas)throw new Error("Canvas is not initialized");return this._canvas}_getContext(){if(!this._context)throw new Error("Context is not initialized");return this._context}_getWidth(){if(!this._width)throw new Error("Width is not initialized");return this._width}_getHeight(){if(!this._height)throw new Error("Height is not initialized");return this._height}_initCanvas(){const e=this.image;if(!e)throw new Error("Image is not initialized");const t=this._canvas=document.createElement("canvas"),i=t.getContext("2d");if(!i)throw new ReferenceError("Failed to create canvas context");this._context=i,t.className="@vibrant/canvas",t.style.display="none",this._width=t.width=e.width,this._height=t.height=e.height,i.drawImage(e,0,0),document.body.appendChild(t)}load(e){let t,i;if(typeof e=="string")t=document.createElement("img"),i=e,!Ce(i)&&!De(window.location.href,i)&&(t.crossOrigin="anonymous"),t.src=i;else if(e instanceof HTMLImageElement)t=e,i=e.src;else return Promise.reject(new Error("Cannot load buffer as an image in browser"));return this.image=t,new Promise((n,a)=>{const s=()=>{this._initCanvas(),n(this)};t.complete?s():(t.onload=s,t.onerror=o=>a(new Error(`Fail to load image: ${i}`)))})}clear(){this._getContext().clearRect(0,0,this._getWidth(),this._getHeight())}update(e){this._getContext().putImageData(e,0,0)}getWidth(){return this._getWidth()}getHeight(){return this._getHeight()}resize(e,t,i){if(!this.image)throw new Error("Image is not initialized");this._width=this._getCanvas().width=e,this._height=this._getCanvas().height=t,this._getContext().scale(i,i),this._getContext().drawImage(this.image,0,0)}getPixelCount(){return this._getWidth()*this._getHeight()}getImageData(){return this._getContext().getImageData(0,0,this._getWidth(),this._getHeight())}remove(){this._canvas&&this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas)}}function ut(r,...e){return e.forEach(t=>{if(t){for(const i in t)if(t.hasOwnProperty(i)){const n=t[i];Array.isArray(n)?r[i]=n.slice(0):typeof n=="object"?(r[i]||(r[i]={}),ut(r[i],n)):r[i]=n}}}),r}function Se(r,e){const{colorCount:t,quantizer:i,generators:n,filters:a}=r,s={colorCount:t},o=typeof i=="string"?{name:i,options:{}}:i;return o.options=ut({},s,o.options),ut({},{quantizer:o,generators:n,filters:a},e)}class Le{constructor(e,t={}){this._src=e,this._opts=ut({},Q.DefaultOpts,t)}maxColorCount(e){return this._opts.colorCount=e,this}maxDimension(e){return this._opts.maxDimension=e,this}addFilter(e){return this._opts.filters?this._opts.filters.push(e):this._opts.filters=[e],this}removeFilter(e){if(this._opts.filters){const t=this._opts.filters.indexOf(e);t>0&&this._opts.filters.splice(t)}return this}clearFilters(){return this._opts.filters=[],this}quality(e){return this._opts.quality=e,this}useImageClass(e){return this._opts.ImageClass=e,this}useGenerator(e,t){return this._opts.generators||(this._opts.generators=[]),this._opts.generators.push(t?{name:e,options:t}:e),this}useQuantizer(e,t){return this._opts.quantizer=t?{name:e,options:t}:e,this}build(){return new Q(this._src,this._opts)}getPalette(){return this.build().getPalette()}}class Dt{constructor(e){this.pipeline=e,this._map={}}names(){return Object.keys(this._map)}has(e){return!!this._map[e]}get(e){return this._map[e]}register(e,t){return this._map[e]=t,this.pipeline}}class Ve{constructor(){this.filter=new Dt(this),this.quantizer=new Dt(this),this.generator=new Dt(this)}_buildProcessTasks({filters:e,quantizer:t,generators:i}){return i.length===1&&i[0]==="*"&&(i=this.generator.names()),{filters:e.map(a=>n(this.filter,a)),quantizer:n(this.quantizer,t),generators:i.map(a=>n(this.generator,a))};function n(a,s){let o,c;return typeof s=="string"?o=s:(o=s.name,c=s.options),{name:o,fn:a.get(o),options:c}}}async process(e,t){const{filters:i,quantizer:n,generators:a}=this._buildProcessTasks(t),s=await this._filterColors(i,e),o=await this._generateColors(n,s),c=await this._generatePalettes(a,o);return{colors:o,palettes:c}}_filterColors(e,t){return Promise.resolve(ke(t,e.map(({fn:i})=>i)))}_generateColors(e,t){return Promise.resolve(e.fn(t.data,e.options))}async _generatePalettes(e,t){const i=await Promise.all(e.map(({fn:n,options:a})=>Promise.resolve(n(t,a))));return Promise.resolve(i.reduce((n,a,s)=>(n[e[s].name]=a,n),{}))}}function Pe(r,e,t){return"#"+((1<<24)+(r<<16)+(e<<8)+t).toString(16).slice(1,7)}function Te(r,e,t){r/=255,e/=255,t/=255;const i=Math.max(r,e,t),n=Math.min(r,e,t);let a=0,s=0;const o=(i+n)/2;if(i!==n){const c=i-n;switch(s=o>.5?c/(2-i-n):c/(i+n),i){case r:a=(e-t)/c+(e<t?6:0);break;case e:a=(t-r)/c+2;break;case t:a=(r-e)/c+4;break}a/=6}return[a,s,o]}function j(r,e,t){let i,n,a;function s(o,c,u){return u<0&&(u+=1),u>1&&(u-=1),u<1/6?o+(c-o)*6*u:u<1/2?c:u<2/3?o+(c-o)*(2/3-u)*6:o}if(e===0)i=n=a=t;else{const o=t<.5?t*(1+e):t+e-t*e,c=2*t-o;i=s(c,o,r+1/3),n=s(c,o,r),a=s(c,o,r-1/3)}return[i*255,n*255,a*255]}class N{static applyFilters(e,t){return t.length>0?e.filter(({r:i,g:n,b:a})=>{var s;for(let o=0;o<t.length;o++)if(!((s=t[o])!=null&&s.call(t,i,n,a,255)))return!1;return!0}):e}static clone(e){return new N(e._rgb,e._population)}get r(){return this._rgb[0]}get g(){return this._rgb[1]}get b(){return this._rgb[2]}get rgb(){return this._rgb}get hsl(){if(!this._hsl){const[e,t,i]=this._rgb;this._hsl=Te(e,t,i)}return this._hsl}get hex(){if(!this._hex){const[e,t,i]=this._rgb;this._hex=Pe(e,t,i)}return this._hex}get population(){return this._population}toJSON(){return{rgb:this.rgb,population:this.population}}getYiq(){if(!this._yiq){const e=this._rgb;this._yiq=(e[0]*299+e[1]*587+e[2]*114)/1e3}return this._yiq}get titleTextColor(){return this._titleTextColor||(this._titleTextColor=this.getYiq()<200?"#fff":"#000"),this._titleTextColor}get bodyTextColor(){return this._bodyTextColor||(this._bodyTextColor=this.getYiq()<150?"#fff":"#000"),this._bodyTextColor}constructor(e,t){this._rgb=e,this._population=t}}const Ht=class St{constructor(e,t){this._src=e,this.opts=ut({},St.DefaultOpts,t)}static use(e){this._pipeline=e}static from(e){return new Le(e)}get result(){return this._result}_process(e,t){e.scaleDown(this.opts);const i=Se(this.opts,t);return St._pipeline.process(e.getImageData(),i)}async getPalette(){const e=new this.opts.ImageClass;try{const t=await e.load(this._src),i=await this._process(t,{generators:["default"]});this._result=i;const n=i.palettes.default;if(!n)throw new Error("Something went wrong and a palette was not found, please file a bug against our GitHub repo: https://github.com/vibrant-Colors/node-vibrant/");return e.remove(),n}catch(t){return e.remove(),Promise.reject(t)}}async getPalettes(){const e=new this.opts.ImageClass;try{const t=await e.load(this._src),i=await this._process(t,{generators:["*"]});this._result=i;const n=i.palettes;return e.remove(),n}catch(t){return e.remove(),Promise.reject(t)}}};Ht.DefaultOpts={colorCount:64,quality:5,filters:[]};let Q=Ht;Q.DefaultOpts.quantizer="mmcq";Q.DefaultOpts.generators=["default"];Q.DefaultOpts.filters=["default"];Q.DefaultOpts.ImageClass=Me;const Lt=5,Mt=8-Lt;class ft{constructor(e,t,i,n,a,s,o){this.histogram=o,this._volume=-1,this._avg=null,this._count=-1,this.dimension={r1:e,r2:t,g1:i,g2:n,b1:a,b2:s}}static build(e){const t=new ye(e,{sigBits:Lt}),{rmin:i,rmax:n,gmin:a,gmax:s,bmin:o,bmax:c}=t;return new ft(i,n,a,s,o,c,t)}invalidate(){this._volume=this._count=-1,this._avg=null}volume(){if(this._volume<0){const{r1:e,r2:t,g1:i,g2:n,b1:a,b2:s}=this.dimension;this._volume=(t-e+1)*(n-i+1)*(s-a+1)}return this._volume}count(){if(this._count<0){const{hist:e,getColorIndex:t}=this.histogram,{r1:i,r2:n,g1:a,g2:s,b1:o,b2:c}=this.dimension;let u=0;for(let h=i;h<=n;h++)for(let _=a;_<=s;_++)for(let p=o;p<=c;p++){const m=t(h,_,p);e[m]&&(u+=e[m])}this._count=u}return this._count}clone(){const{histogram:e}=this,{r1:t,r2:i,g1:n,g2:a,b1:s,b2:o}=this.dimension;return new ft(t,i,n,a,s,o,e)}avg(){if(!this._avg){const{hist:e,getColorIndex:t}=this.histogram,{r1:i,r2:n,g1:a,g2:s,b1:o,b2:c}=this.dimension;let u=0;const h=1<<8-Lt;let _,p,m;_=p=m=0;for(let f=i;f<=n;f++)for(let d=a;d<=s;d++)for(let b=o;b<=c;b++){const O=t(f,d,b),k=e[O];k&&(u+=k,_+=k*(f+.5)*h,p+=k*(d+.5)*h,m+=k*(b+.5)*h)}u?this._avg=[~~(_/u),~~(p/u),~~(m/u)]:this._avg=[~~(h*(i+n+1)/2),~~(h*(a+s+1)/2),~~(h*(o+c+1)/2)]}return this._avg}contains(e){let[t,i,n]=e;const{r1:a,r2:s,g1:o,g2:c,b1:u,b2:h}=this.dimension;return t>>=Mt,i>>=Mt,n>>=Mt,t>=a&&t<=s&&i>=o&&i<=c&&n>=u&&n<=h}split(){const{hist:e,getColorIndex:t}=this.histogram,{r1:i,r2:n,g1:a,g2:s,b1:o,b2:c}=this.dimension,u=this.count();if(!u)return[];if(u===1)return[this.clone()];const h=n-i+1,_=s-a+1,p=c-o+1,m=Math.max(h,_,p);let f=null,d,b;d=b=0;let O=null;if(m===h){O="r",f=new Uint32Array(n+1);for(let y=i;y<=n;y++){d=0;for(let C=a;C<=s;C++)for(let L=o;L<=c;L++){const A=t(y,C,L);e[A]&&(d+=e[A])}b+=d,f[y]=b}}else if(m===_){O="g",f=new Uint32Array(s+1);for(let y=a;y<=s;y++){d=0;for(let C=i;C<=n;C++)for(let L=o;L<=c;L++){const A=t(C,y,L);e[A]&&(d+=e[A])}b+=d,f[y]=b}}else{O="b",f=new Uint32Array(c+1);for(let y=o;y<=c;y++){d=0;for(let C=i;C<=n;C++)for(let L=a;L<=s;L++){const A=t(C,L,y);e[A]&&(d+=e[A])}b+=d,f[y]=b}}let k=-1;const q=new Uint32Array(f.length);for(let y=0;y<f.length;y++){const C=f[y];C&&(k<0&&C>b/2&&(k=y),q[y]=b-C)}const S=this;function R(y){const C=y+"1",L=y+"2",A=S.dimension[C];let V=S.dimension[L];const ht=S.clone(),at=S.clone(),Y=k-A,st=V-k;for(Y<=st?(V=Math.min(V-1,~~(k+st/2)),V=Math.max(0,V)):(V=Math.max(A,~~(k-1-Y/2)),V=Math.min(S.dimension[L],V));!f[V];)V++;let ot=q[V];for(;!ot&&f[V-1];)ot=q[--V];return ht.dimension[L]=V,at.dimension[C]=V+1,[ht,at]}return R(O)}}class Ut{_sort(){this._sorted||(this.contents.sort(this._comparator),this._sorted=!0)}constructor(e){this._comparator=e,this.contents=[],this._sorted=!1}push(e){this.contents.push(e),this._sorted=!1}peek(e){return this._sort(),e=typeof e=="number"?e:this.contents.length-1,this.contents[e]}pop(){return this._sort(),this.contents.pop()}size(){return this.contents.length}map(e){return this._sort(),this.contents.map(e)}}const Ie=.75;function $t(r,e){let t=r.size();for(;r.size()<e;){const i=r.pop();if(i&&i.count()>0){const[n,a]=i.split();if(!n||(r.push(n),a&&a.count()>0&&r.push(a),r.size()===t))break;t=r.size()}else break}}const ze=(r,e)=>{if(r.length===0||e.colorCount<2||e.colorCount>256)throw new Error("Wrong MMCQ parameters");const t=ft.build(r);t.histogram.colorCount;const i=new Ut((a,s)=>a.count()-s.count());i.push(t),$t(i,Ie*e.colorCount);const n=new Ut((a,s)=>a.count()*a.volume()-s.count()*s.volume());return n.contents=i.contents,$t(n,e.colorCount-n.size()),Ee(n)};function Ee(r){const e=[];for(;r.size();){const t=r.pop(),i=t.avg();e.push(new N(i,t.count()))}return e}const Oe={targetDarkLuma:.26,maxDarkLuma:.45,minLightLuma:.55,targetLightLuma:.74,minNormalLuma:.3,targetNormalLuma:.5,maxNormalLuma:.7,targetMutesSaturation:.3,maxMutesSaturation:.4,targetVibrantSaturation:1,minVibrantSaturation:.35,weightSaturation:3,weightLuma:6.5,weightPopulation:.5};function Ae(r){let e=0;return r.forEach(t=>{e=Math.max(e,t.population)}),e}function Ne(r,e){return r.Vibrant===e||r.DarkVibrant===e||r.LightVibrant===e||r.Muted===e||r.DarkMuted===e||r.LightMuted===e}function Re(r,e,t,i,n,a,s){function o(...u){let h=0,_=0;for(let p=0;p<u.length;p+=2){const m=u[p],f=u[p+1];!m||!f||(h+=m*f,_+=f)}return h/_}function c(u,h){return 1-Math.abs(u-h)}return o(c(r,e),s.weightSaturation,c(t,i),s.weightLuma,n/a,s.weightPopulation)}function nt(r,e,t,i,n,a,s,o,c,u){let h=null,_=0;return e.forEach(p=>{const[,m,f]=p.hsl;if(m>=o&&m<=c&&f>=n&&f<=a&&!Ne(r,p)){const d=Re(m,s,f,i,p.population,t,u);(h===null||d>_)&&(h=p,_=d)}}),h}function Ue(r,e,t){const i={Vibrant:null,DarkVibrant:null,LightVibrant:null,Muted:null,DarkMuted:null,LightMuted:null};return i.Vibrant=nt(i,r,e,t.targetNormalLuma,t.minNormalLuma,t.maxNormalLuma,t.targetVibrantSaturation,t.minVibrantSaturation,1,t),i.LightVibrant=nt(i,r,e,t.targetLightLuma,t.minLightLuma,1,t.targetVibrantSaturation,t.minVibrantSaturation,1,t),i.DarkVibrant=nt(i,r,e,t.targetDarkLuma,0,t.maxDarkLuma,t.targetVibrantSaturation,t.minVibrantSaturation,1,t),i.Muted=nt(i,r,e,t.targetNormalLuma,t.minNormalLuma,t.maxNormalLuma,t.targetMutesSaturation,0,t.maxMutesSaturation,t),i.LightMuted=nt(i,r,e,t.targetLightLuma,t.minLightLuma,1,t.targetMutesSaturation,0,t.maxMutesSaturation,t),i.DarkMuted=nt(i,r,e,t.targetDarkLuma,0,t.maxDarkLuma,t.targetMutesSaturation,0,t.maxMutesSaturation,t),i}function $e(r,e,t){if(!r.Vibrant&&!r.DarkVibrant&&!r.LightVibrant){if(!r.DarkVibrant&&r.DarkMuted){let[i,n,a]=r.DarkMuted.hsl;a=t.targetDarkLuma,r.DarkVibrant=new N(j(i,n,a),0)}if(!r.LightVibrant&&r.LightMuted){let[i,n,a]=r.LightMuted.hsl;a=t.targetDarkLuma,r.DarkVibrant=new N(j(i,n,a),0)}}if(!r.Vibrant&&r.DarkVibrant){let[i,n,a]=r.DarkVibrant.hsl;a=t.targetNormalLuma,r.Vibrant=new N(j(i,n,a),0)}else if(!r.Vibrant&&r.LightVibrant){let[i,n,a]=r.LightVibrant.hsl;a=t.targetNormalLuma,r.Vibrant=new N(j(i,n,a),0)}if(!r.DarkVibrant&&r.Vibrant){let[i,n,a]=r.Vibrant.hsl;a=t.targetDarkLuma,r.DarkVibrant=new N(j(i,n,a),0)}if(!r.LightVibrant&&r.Vibrant){let[i,n,a]=r.Vibrant.hsl;a=t.targetLightLuma,r.LightVibrant=new N(j(i,n,a),0)}if(!r.Muted&&r.Vibrant){let[i,n,a]=r.Vibrant.hsl;a=t.targetMutesSaturation,r.Muted=new N(j(i,n,a),0)}if(!r.DarkMuted&&r.DarkVibrant){let[i,n,a]=r.DarkVibrant.hsl;a=t.targetMutesSaturation,r.DarkMuted=new N(j(i,n,a),0)}if(!r.LightMuted&&r.LightVibrant){let[i,n,a]=r.LightVibrant.hsl;a=t.targetMutesSaturation,r.LightMuted=new N(j(i,n,a),0)}}const He=(r,e)=>{e=Object.assign({},Oe,e);const t=Ae(r),i=Ue(r,t,e);return $e(i,t,e),i},qe=new Ve().filter.register("default",(r,e,t,i)=>i>=125&&!(r>250&&e>250&&t>250)).quantizer.register("mmcq",ze).generator.register("default",He);Q.use(qe);var Be=H('<button class="svelte-1uha8ag">Sign Out</button>'),We=H('<button class="svelte-1uha8ag">Sign In</button>'),Fe=H('<p class="err svelte-1uha8ag"> </p>'),je=H('<div class="svelte-1uha8ag"></div>'),Ge=H('<img class="cover svelte-1uha8ag" alt="album art" width="520" height="520"/>'),Qe=H('<div class="layout svelte-1uha8ag"><div class="left svelte-1uha8ag"><h1 class="title svelte-1uha8ag"> </h1> <div class="sub svelte-1uha8ag"> </div> <div class="progress svelte-1uha8ag" role="slider" tabindex="0" aria-label="Playback position" aria-valuemin="0"><!></div> <div class="times svelte-1uha8ag"> </div> <div class="controls svelte-1uha8ag" role="group" aria-label="Playback controls"><button class="ctrl svelte-1uha8ag" aria-label="Previous">â®</button> <button class="ctrl big svelte-1uha8ag"> </button> <button class="ctrl svelte-1uha8ag" aria-label="Next">â­</button></div> <section class="info svelte-1uha8ag"><h3 class="svelte-1uha8ag">General Track Information</h3> <div class="kv svelte-1uha8ag"><div> </div> <div> </div></div></section></div> <div class="right svelte-1uha8ag"><div class="artwrap svelte-1uha8ag"><!> <div aria-hidden="true"></div></div></div></div>'),Ye=H('<div class="playing-zero svelte-1uha8ag" role="region" aria-label="Nothing is playing"><div class="zero-card svelte-1uha8ag"><h2 class="svelte-1uha8ag">Nothing is playing</h2> <p class="lead svelte-1uha8ag">Start playback on any Spotify device to show album art and the vinyl visualizer.</p> <p class="hint svelte-1uha8ag">Tip: open Spotify on your phone, laptop or web player and press play.</p></div></div>'),Je=H("<!> <!>",1),Xe=H('<p class="err svelte-1uha8ag"> </p>'),Ke=H('<!> <div class="zero-state svelte-1uha8ag" role="region" aria-label="Sign in to Sonora"><div class="zero-card svelte-1uha8ag"><h2 class="svelte-1uha8ag">Youâre signed out</h2> <p class="lead svelte-1uha8ag">Sign in with Spotify to show currently playing tracks, album art and the vinyl visualizer.</p> <button class="btn svelte-1uha8ag">Sign in with Spotify</button> <p class="hint svelte-1uha8ag">No account? Visit <a href="https://spotify.com" target="_blank" rel="noopener noreferrer" class="svelte-1uha8ag">spotify.com</a>.</p></div></div>',1),Ze=H("<div><span></span> <span> </span> <!></div> <!>",1);function oi(r,e){ue(e,!1);const t=F(),i=F(),n=F(),a="Sonora ð§";function s(){try{document.title=a}catch{}}let c=["Vibrant","DarkVibrant","DarkMuted","Muted"];{try{const g=new URL(location.href).searchParams.get("swatch");g&&(c=g.split(",").map(v=>v.trim()).filter(Boolean))}catch{}window.__VIBRANT_SWATCH_ORDER=c}let u=F(!1),h=F(null),_=F(null),p=null,m=F(null),f,d=F(null),b=F(null);function O(g){const v=Math.floor((g||0)/1e3),w=Math.floor(v/60),I=String(v%60).padStart(2,"0");return`${w}:${I}`}async function k(){try{const g=await me();x(h,g||null),x(m,null);const v=g?.item?.id||null;v&&v!==p&&(p=v,x(_,g?.item?.popularity==null?await de(v):null))}catch(g){x(m,String(g))}}async function q(){try{await rt("/me/player/play",{method:"PUT"}),await k()}catch(g){x(m,String(g))}}async function S(){try{await rt("/me/player/pause",{method:"PUT"}),await k()}catch(g){x(m,String(g))}}async function R(){try{await rt("/me/player/next",{method:"POST"}),setTimeout(k,250)}catch(g){x(m,String(g))}}async function y(){try{await rt("/me/player/previous",{method:"POST"}),setTimeout(k,250)}catch(g){x(m,String(g))}}function C(){l(h)?.is_playing?S():q()}async function L(g){if(!(!l(t)||!l(t).duration_ms))try{const v=g.currentTarget.getBoundingClientRect(),w=g.clientX-v.left,I=Math.max(0,Math.min(1,w/v.width)),B=Math.floor(I*l(t).duration_ms);await rt(`/me/player/seek?position_ms=${B}`,{method:"PUT"}),setTimeout(k,200)}catch(v){x(m,String(v))}}function A(g){if(!l(t)||!l(h))return;const v=5e3;let w=l(h)?.progress_ms||0;if(g.key==="ArrowLeft")g.preventDefault(),w=Math.max(0,w-v);else if(g.key==="ArrowRight")g.preventDefault(),w=Math.min(l(t).duration_ms,w+v);else if(g.key==="Home")g.preventDefault(),w=0;else if(g.key==="End")g.preventDefault(),w=l(t).duration_ms;else if(g.key===" "||g.key==="Enter"){g.preventDefault(),C();return}else return;rt(`/me/player/seek?position_ms=${Math.floor(w)}`,{method:"PUT"}).then(()=>setTimeout(k,150)).catch(I=>x(m,String(I)))}function V(){ve(),x(u,!1),x(h,null),x(_,null),p=null,f&&(clearInterval(f),f=null),s()}async function ht(g){try{if(!g){x(d,null),x(b,null);return}const v=await Q.from(g).getPalette();let w=null;for(const I of c)if(v?.[I]){w=v[I];break}if(w||(w=Object.values(v).find(Boolean)||null),w?.rgb){const[I,B,J]=w.rgb;x(d,`rgba(${Math.round(I)}, ${Math.round(B)}, ${Math.round(J)}, 1)`),x(b,`rgba(${Math.round(I)}, ${Math.round(B)}, ${Math.round(J)}, 1)`)}else w?.hex?(x(d,w.hex),x(b,w.hex)):(x(d,null),x(b,null))}catch{x(d,null),x(b,null)}}oe(async()=>{x(u,fe()),l(u)&&(await k(),f=setInterval(k,1e3)),s()}),le(()=>{f&&clearInterval(f)}),lt(()=>l(h),()=>{x(t,l(h)?.item)}),lt(()=>l(t),()=>{x(i,l(t)?.album?.images?.[0]?.url||"")}),lt(()=>(l(t),l(_)),()=>{x(n,l(t)?.popularity??l(_)?.popularity??null)}),lt(()=>l(i),()=>{l(i)&&ht(l(i))}),lt(()=>we,()=>{s()}),he(),se();var at=Ze(),Y=kt(at);let st;var ot=D(Y),mt=P(ot,2),qt=D(mt);M(mt);var Bt=P(mt,2);{var Wt=g=>{var v=Be();G("click",v,V),$(g,v)},Ft=g=>{var v=We();G("click",v,function(...w){At?.apply(this,w)}),$(g,v)};tt(Bt,g=>{l(u)?g(Wt):g(Ft,!1)})}M(Y);var jt=P(Y,2);{var Gt=g=>{var v=Je(),w=kt(v);{var I=T=>{var z=Fe(),X=D(z,!0);M(z),it(()=>W(X,l(m))),$(T,z)};tt(w,T=>{l(m)&&T(I)})}var B=P(w,2);{var J=T=>{var z=Qe(),X=D(z),vt=D(X),Yt=D(vt,!0);M(vt);var _t=P(vt,2),Jt=D(_t);M(_t);var K=P(_t,2),Xt=D(K);{var Kt=U=>{var Z=je();it(xt=>Rt(Z,xt),[()=>(l(h),l(t),E(()=>`width:${Math.min(100,100*(l(h)?.progress_ms||0)/l(t).duration_ms)}%`))]),$(U,Z)};tt(Xt,U=>{l(t),E(()=>l(t).duration_ms)&&U(Kt)})}M(K);var bt=P(K,2),Zt=D(bt);M(bt);var pt=P(bt,2),wt=D(pt),et=P(wt,2),te=D(et,!0);M(et);var Vt=P(et,2);M(pt);var Pt=P(pt,2),Tt=P(D(Pt),2),yt=D(Tt),ee=D(yt);M(yt);var It=P(yt,2),ie=D(It);M(It),M(Tt),M(Pt),M(X);var zt=P(X,2),Et=D(zt),Ot=D(Et);{var re=U=>{var Z=Ge();it(()=>ct(Z,"src",l(i))),$(U,Z)};tt(Ot,U=>{l(i)&&U(re)})}var ne=P(Ot,2);M(Et),M(zt),M(z),it((U,Z,xt,ae)=>{Rt(z,`--label:url(${l(i)}); --glow:${l(d)??""}; --glow-soft:${l(b)??""};`),W(Yt,(l(t),E(()=>l(t).name))),W(Jt,`${U??""} â¢ ${l(t),E(()=>l(t).album?.name)??""}`),ct(K,"aria-valuemax",(l(t),E(()=>l(t)?.duration_ms))),ct(K,"aria-valuenow",(l(h),E(()=>l(h)?.progress_ms??0))),W(Zt,`${Z??""} / ${xt??""}
                    ${l(h),E(()=>l(h)?.is_playing?"â¢ Playing":"â¢ Paused")??""}`),wt.disabled=!l(u),ct(et,"aria-label",(l(h),E(()=>l(h)?.is_playing?"Pause":"Play"))),et.disabled=!l(u),W(te,(l(h),E(()=>l(h)?.is_playing?"â¸":"â¶"))),Vt.disabled=!l(u),W(ee,`â³ Duration: ${ae??""}`),W(ie,`ð¥ popularity: ${l(n)??"â"??""}`),Ct(ne,1,`vinyl ${l(h),E(()=>l(h)?.is_playing?"spinning":"")??""}`,"svelte-1uha8ag")},[()=>(l(t),E(()=>l(t).artists?.map(U=>U.name).join(", "))),()=>(l(h),E(()=>O(l(h)?.progress_ms))),()=>(l(t),E(()=>O(l(t).duration_ms))),()=>(l(t),E(()=>O(l(t).duration_ms)))]),G("click",K,L),G("keydown",K,A),G("click",wt,y),G("click",et,C),G("click",Vt,R),$(T,z)},dt=T=>{var z=Ye();$(T,z)};tt(B,T=>{l(t)?T(J):T(dt,!1)})}$(g,v)},Qt=g=>{var v=Ke(),w=kt(v);{var I=T=>{var z=Xe(),X=D(z,!0);M(z),it(()=>W(X,l(m))),$(T,z)};tt(w,T=>{l(m)&&T(I)})}var B=P(w,2),J=D(B),dt=P(D(J),4);ge(2),M(J),M(B),G("click",dt,function(...T){At?.apply(this,T)}),$(g,v)};tt(jt,g=>{l(u)?g(Gt):g(Qt,!1)})}it(g=>{st=Ct(Y,1,"status svelte-1uha8ag",null,st,g),Ct(ot,1,`dot ${l(u)?"green":"red"}`,"svelte-1uha8ag"),W(qt,`Status: ${l(u)?"Connected":"Disconnected"}`)},[()=>({connected:l(u),disconnected:!l(u)})]),$(r,at),ce()}export{oi as component};
